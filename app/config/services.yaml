parameters:
    faker.locale: 'en_US'

services:
    _defaults:
        autowire: true
        autoconfigure: true

    _instanceof:
        Smile\GdprDump\Configuration\Compiler\Processor\Processor:
            tags: ['config.compiler_processor']
        Smile\GdprDump\Converter\Converter:
            shared: false # the converter factory uses the container to create new instances
            tags: ['converter'] # used by ConverterAliasPass to create aliases for data converters
        Smile\GdprDump\Dumper\Dumper:
            tags: ['dumper']
        Smile\GdprDump\Phar\Minify\Minifier:
            tags: ['compiler.minifier']
        Symfony\Component\Console\Command\Command:
            public: true # used by Kernel

    Smile\GdprDump\:
        resource: '../../src/'
        exclude:
            - '../../src/Kernel.php'
            - '../../src/Util/*.php'
            - '../../src/**/*Exception.php'

    Smile\GdprDump\Console\Command\CompileCommand:
        $defaultLocale: '%faker.locale%'

    Smile\GdprDump\Configuration\ConfigurationFactory:
        public: true # used by functional tests

    Smile\GdprDump\Configuration\Compiler\ConfigurationCompiler:
        arguments:
            $processors: !tagged_iterator 'config.compiler_processor'

    Smile\GdprDump\Dumper\DumperResolver:
        public: true # used by functional tests
        arguments:
            $dumperLocator: !tagged_locator 'dumper'

    Smile\GdprDump\Faker\LazyGeneratorFactory:
        arguments:
            $defaultLocale: '%faker.locale%'

    Smile\GdprDump\Phar\Minify\MinifierResolver:
        arguments:
            $minifierLocator: !tagged_locator compiler.minifier
